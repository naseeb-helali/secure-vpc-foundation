flowchart LR
  subgraph Public_Subnet
    IGW[Internet Gateway]
    Bastion[Bastion Host - EIP]
    NATi[NAT Instance]
    RTpub[Public Route Table]
  end

  subgraph Private_Subnet
    AppEC2[EC2 - Private]
    RTpriv[Private Route Table]
  end

  S3[(S3 Bucket)]
  GWEP[S3 Gateway Endpoint]

  %% Internet for public resources
  RTpub --> IGW
  IGW --- Bastion
  IGW --- NATi

  %% Secure admin path inside VPC
  Bastion -. SSH .-> AppEC2

  %% Private egress via NAT Instance
  RTpriv -. "0.0.0.0/0" .-> NATi
  AppEC2 -. egress .-> NATi

  %% Private S3 access via Gateway Endpoint
  RTpriv --> GWEP
  AppEC2 --> GWEP --> S3

  %% Design notes:
  %% - NAT Instance in Public Subnet + disable Source/Dest Check
  %% - Bastion in Public Subnet + restrict SSH (Least Privilege)
  %% - Private RT sends 0.0.0.0/0 to the NAT Instance interface
  %% - S3 Gateway Endpoint attached to Private RT for internal access
